# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## What This Is

Personal blog for **cuiliang.ai** — an AI Agent engineering blog by LiangShu (Principal Software Manager @ Microsoft). Built with Hugo and the PaperMod theme, deployed to GitHub Pages via GitHub Actions.

- **Site URL:** https://cuiliang.ai/
- **Topics:** AI Agent, CUA, MCP, LLM, Computer Use Agent
- **Language:** Content is primarily in Chinese (hasCJKLanguage: true), site chrome is in English

## Git 提交规则

**必须使用原生 git 命令**（`git add`、`git commit`、`git push` 等）提交代码变更。**禁止使用 coding-flow MCP 工具**（如 `commit_and_push`、`create_draft_pr`、`submit_changes` 等）进行代码提交操作。

## Common Commands

```bash
# Local development (requires Hugo extended edition)
hugo server -D              # Serve with drafts enabled
hugo server                 # Serve production content only

# Build for production
hugo --gc --minify          # Matches CI build (without --baseURL override)

# Create a new post
hugo new content/posts/my-post-title/index.md
```

Hugo is **not** installed locally by default. The CI workflow uses Hugo Extended **v0.147.0**. Install matching version locally:
```bash
# Windows (scoop)
scoop install hugo-extended
# Or download from https://github.com/gohugoio/hugo/releases/tag/v0.147.0
```

## Deployment

Push to `main` branch triggers `.github/workflows/deploy.yml`:
1. Installs Hugo Extended 0.147.0
2. Checks out repo with submodules (recursive, full history)
3. Builds with `hugo --gc --minify` (TZ=Asia/Shanghai, production env)
4. Deploys to GitHub Pages

No manual deployment steps needed — push to `main` and CI handles the rest.

## Repository Structure

```
hugo.yaml           # All site config (theme, params, menus, markup)
content/            # Markdown content
  archives.md       # Archives page (layout: archives)
  search.md         # Search page (layout: search, uses Fuse.js)
  posts/            # Blog posts go here (create as page bundles)
themes/PaperMod/    # Git submodule → github.com/adityatelange/hugo-PaperMod
static/CNAME        # Custom domain: cuiliang.ai
archetypes/         # Hugo new content templates
public/             # Build output (committed but regenerated by CI)
```

## Key Configuration Details (hugo.yaml)

- **Theme:** PaperMod (loaded as git submodule)
- **Outputs:** HTML + RSS + JSON (JSON enables client-side search via Fuse.js)
- **Markup:** Goldmark with `unsafe: true` (raw HTML allowed in Markdown), Dracula code highlighting with line numbers
- **Menus:** Search, Tags, Archives, About
- **Features enabled:** reading time, share buttons, post nav links, breadcrumbs, code copy buttons, word count, ToC (Hugo native)

## Content Conventions

- Posts should be created as **page bundles** under `content/posts/<slug>/index.md` so images can be co-located
- Front matter uses YAML (matching hugo.yaml format)
- New posts default to `draft: true` (from archetypes/default.md) — set `draft: false` to publish
- The archetype uses TOML delimiters (`+++`); you may convert to YAML `---` for consistency

## Submodule Note

The PaperMod theme is a git submodule. After a fresh clone, initialize it:
```bash
git submodule update --init --recursive
```
